# Условия некорректны

По определению "порядок полей, пунктуация и слова со временем могут быть изменены".

Можно без потери общности положить, что ничего кроме искомых значений разделенных пробелами в сообщении нет.

## Контрпример 1

Сумма списания не всегда содержит один из символов ',' или '.', если верить эмулятору:

![124][1]

[1]: https://github.com/vadim-malashenko/funpay/blob/master/parse_sms/1.jpg

Тогда сообщение "123 124 01234567891" валидно по определению, но исходя только из условий невозможно определить где в нем код подтверждения, а где сумма списания.

## Контрпример 2

Эмулятор возвращает только четырехзначные числовые коды, но в условиях ничего не сказано о том из каких символов и в каком количестве может состоять код подтверждения.

Значит сообщение 01234567890 123,40 01234567891 валидно по определению, но исходя только из условий невозможно определить где в нем код подтверждения, а где номер кошелька.

## Решение

Чтобы сделать задачу решаемой необходимо и достаточно добавить условия:

1. [номер кошелька содержит от 11 до 20 цифр включительно](https://kassa.yandex.ru/tech/payout/wallet.html)
2. код подтверждения содержит не более 10 цифр
3. сумма списания содержит цифры и один из символов ',' или '.', за которым следует цифра

Тогда можно предложить следующее решение:

```php
<?php // 7+

function parse_sms (string $message) : array {
        
    return array_reduce (
        
        explode (
            ' ',
            trim (
                preg_replace (
                    '#[^\d,.]+#',
                    ' ',
                    preg_replace (
                        '#(^[,.])|(\D[,.])|([,.]\D)|([,.]$)#',
                        ' ',
                        $message
                    )
                )
            )
        ),
        
        function ($result, $value) {
            
            if (preg_match ('#[,.]#', $value))
            
                $result ['amount'] = floatval (str_replace (',', '.', $value));
            
            elseif (strlen ($value) < 11)
            
                $result ['code'] = $value;
                
            elseif (strlen ($value) <= 20)
            
                $result ['account'] = $value;
            
            return $result;
        },
        
        []
    )
    
    + [
        'code' => NULL,
        'account' => NULL,
        'amount' => NULL
    ];
}
